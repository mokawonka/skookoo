<h3 class="pt-4 pb-4">
  <%= image_tag('watermelon.svg', class: "header-icon") %>
  My Vocabulary
  <div class="subtitle">Private collection of words & definitions</div>
</h3>

<div id="myvocabulary">

  <% if @records.count > 0 %>

    <% @records.order('created_at DESC').each do |exp| %>
      <% document = Document.find_by(id: exp.docid) %>

      <div class="vocabulary-card mb-4">

        <div class="card-header d-flex justify-content-between align-items-center">
          <div>
            <strong class="lemongreen">
              <%= document&.title || "Unknown Book" %>
            </strong>
            <br>
            <small class="text-muted">
              <%= document&.authors || "Unknown Author" %>
            </small>
          </div>
          
          <%= button_to '', exp, method: :delete, 
                class: "btn-close", 
                data: { confirm: "Delete this vocabulary item?" } %>
        </div>

        <div class="card-body">
          <div class="content-section">
            <small class="text-muted">Phrase / Word</small>
            
              <% if document %>
                <%= link_to exp.content, 
                      document_path(exp.docid, cfi: exp.cfi), 
                      class: "content-text d-block", 
                      target: "_blank" %>
              <% else %>
                <span class="content-text d-block text-muted">
                  <%= exp.content %>
                  <small class="d-block text-danger">(Original document was deleted)</small>
                </span>
              <% end %>
          </div>

          <hr>

          <div class="definition-section">
            <small class="text-muted">Definition</small>
            <p class="definition-text">
              <%= exp.definition.present? ? exp.definition : "<span class='text-muted fst-italic'>No definition yet</span>".html_safe %>
            </p>
          </div>
        </div>

      </div>
    <% end %>

  <% else %>

    <div class="centered text-center dimmed pt-5">
      <%= image_tag 'empty_basket.png', size: '100x100' %>
      <p class="mt-3">No vocabulary collected yet</p>
    </div>

  <% end %>

</div>

<%== pagy_bootstrap_nav(@pagy) if @pagy&.pages.to_i > 1 %>